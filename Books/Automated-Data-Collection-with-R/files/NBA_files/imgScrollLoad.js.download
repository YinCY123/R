define(['require','js/util/webp'],function(require){var a,c,h,g=require("js/util/webp"),_=-1!=navigator.appVersion.indexOf("MSIE 6")?!0:!1,d=document,b=window,v=document.body,E=document.documentElement,p=[],O=function(){A.scroll()},j=-1,H=d.images.length,y={$:function(a){return d.getElementById?d.getElementById(a):d.all[a]},addEvent:function(a,c,h){a.attachEvent?a.attachEvent("on"+c,h):a.addEventListener(c,h,!1)},delEvent:function(a,c,h){a.detachEvent?a.detachEvent("on"+c,h):a.removeEventListener(c,h,!1)},absPosition:function(a,c){var h=a.offsetLeft,g=a.offsetTop,_=a.offsetParent;try{for(;_!=v&&_!=d.documentElement&&_!=c&&null!=_;)h+=_.offsetLeft,g+=_.offsetTop,_=_.offsetParent}catch(e){}return{left:h,top:g}}},A=window.scrollLoad={status:"complete",mult:2,init:function(){var a=this;g.isSupport(function(){a._init()})},_init:function(c){var h,g=this,_=0;h=c&&c.getElementsByTagName?c.getElementsByTagName("img"):d.images;for(var i=0;i<h.length;i++)if(h[i].getAttribute("data-src")&&!h[i].__isSL){if(0==h[i].offsetWidth&&0==h[i].offsetHeight)for(h[i].__pObj=h[i].parentNode;0==h[i].__pObj.offsetWidth&&0==h[i].__pObj.offsetHeight;)h[i].__pObj=h[i].__pObj.parentNode;h[i].__isSL=!0,p.push(h[i]),_++}_>0&&("scrolling"!=this.status&&(y.addEvent(b,"scroll",O),this.status="scrolling",a=setInterval(function(){g.timer()},200)),this.scroll())},timer:function(){H!==d.images.length&&(H=d.images.length,this.init());var a=Math.min(E.clientHeight,v.clientHeight),g=(b.pageYOffset||v.scrollTop||E.scrollTop)-Math.round(a*(this.mult-1)/2),_=g+Math.round(a*((this.mult-1)/2+1));(c!==g||_!==h)&&this.scroll()},showImg:function(a){return a.getAttribute("data-src")&&(a.removeAttribute("data-top"),a.__pObj=null,a.__isSL=null,a.src=g.get(a.getAttribute("data-src")),a.removeAttribute("data-src"),_)?!1:void 0},scroll:function(g){if("scrolling"==this.status){var _=0;j==d.body.scrollHeight?_=1:j=d.body.scrollHeight,"undefined"!=typeof g&&g&&(_=0);var H=Math.min(E.clientHeight,v.clientHeight),A=(b.pageYOffset||v.scrollTop||E.scrollTop)-Math.round(H*(this.mult-1)/2),w=A+Math.round(H*((this.mult-1)/2+1));c=A,h=w;for(var I,L,s=0,i=0;i<p.length;i++)if(p[i].getAttribute("data-src")&&"hidden"!==p[i].getAttribute("data-imgscrollload")){if(s++,_)I=p[i].getAttribute("data-top");else{if(0==p[i].offsetWidth&&0==p[i].offsetHeight){if(p[i].__pObj=p[i].parentNode,!p[i].__pObj){this.showImg(p[i]);continue}for(;p[i].__pObj&&0==p[i].__pObj.offsetWidth&&0==p[i].__pObj.offsetHeight;)p[i].__pObj=p[i].__pObj.parentNode}L=p[i].__pObj||p[i],I=y.absPosition(L,v).top,p[i].setAttribute("data-top",I)}I>=A&&w>=I&&this.showImg(p[i])}0==s&&(this.status="complete",y.delEvent(b,"scroll",O),clearInterval(a))}}};return A});