define(['require','js/lib/jquery','js/util/queryToJson','js/util/renderLazyContent'],function(require){var a=(require("js/lib/jquery"),require("js/util/queryToJson")),c=require("js/util/renderLazyContent"),v={},y=null,h="layer-type",g="click",L="undefined"!=typeof window.ontouchstart;L&&(g="touchstart");var w=function(c){if(!c||0===c.length)return{};var v={clz:"selected",position:""},y=a(c.attr("layer-data")||"");return $.extend(!0,{},v,y)},T=function(a){if(clearTimeout(y),j(),a&&0!==a.length){var g=0,L=a.parents("["+h+"=layer-wrap]").eq(0),T=$("["+h+"=layer-nav]",L),C=$("["+h+"=layer-cont]",L),D=w(L),W=D.clz,b=D.position;if(0===L.length&&(L=$(z)),T.length==C.length){g="layer-nav"===a.attr(h)?T.index(a):C.index(a);var F=T.eq(g),U=C.eq(g);if(F.addClass(W),"no"!==b){var k=$("["+h+"=arrow]",U),A=0,B=0;U.data("marginLeft")?(A=U.data("marginLeft"),B=k.data("marginLeft")):(A=parseFloat(U.css("marginLeft")),B=parseFloat(k.css("marginLeft")),U.data("marginLeft",A),k.data("marginLeft",B));var E=U.outerWidth(),J=F.position().left-E/2+F.outerWidth()/2,G=E/2-k.outerWidth()/2,H=L.outerWidth()-E,I=H-A;0>J?(G+=J,J=0,A=0,B=0):J>I&&(G+=J-H,J=H,A=0,B=0),U.css({left:J,marginLeft:A}),k.css({left:G,marginLeft:B})}U.stop().slideDown(200),c(U),v={nav:F,cont:U},F.data("display",!0)}}},j=function(a){if(v.nav&&v.cont){var c=v.nav.parents("["+h+"=layer-wrap]").eq(0),g=v.nav,$=v.cont,L=w(c).clz;a?y=setTimeout(function(){g.removeClass(L),$.stop().slideUp(200)},a||0):(g.removeClass(L),$.stop().slideUp(200)),g.data("display",!1)}},z=$("body");return z.data("layer-init")||(L?(z.on(g,"["+h+"=layer-nav]",function(e){var a=$(this);a.data("display")?j():T($(this)),e.preventDefault()}),$(window).on(g,function(e){e.target.getAttribute("layer-type")||j()})):(z.on("mouseenter","["+h+"=layer-nav]",function(e){var a=$(this),c=w(a).eventType;"mouseenter"===c&&(T($(this)),e.preventDefault())}),z.on("mouseleave","["+h+"=layer-nav],["+h+"=layer-cont]",function(e){var a=$(this),c=w(a).eventType;"mouseenter"===c&&(j(300),e.preventDefault())}),z.on("mouseenter","["+h+"=layer-cont]",function(){var a=$(this),c=w(a).eventType;"mouseenter"===c&&clearTimeout(y)})),z.data("layer-init",!0)),{showByEle:T,hide:j}});