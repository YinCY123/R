define(["require","exports","module","js/lib/jquery","js/util/clz","js/util/getNodes","js/component/common/layer","userpanel"],function(e,n,i){var s,o=(e("js/lib/jquery"),e("js/util/clz")),t=e("js/util/getNodes"),r=(e("js/component/common/layer"),e("userpanel"),window),c=new o,u=null;return c.include({init:function(e,n){var i=this;if(i.dom=t(e),!i.data("init")){var o=r.SINA_USER_PANEL;o.set("container",{node:i.dom.user[0]}).set("extra",{css:"//i.sso.sina.com.cn/css/outlogin/v1/outlogin_skin_reversion.css"}).set("outLoginLayer",{ready:function(){s=r.SINA_OUTLOGIN_LAYER,s&&(s.set("sso",{entry:n.entry||"account"}).set("plugin",{position:"center",parentNode:null,relatedNode:null}).set("mask",{enable:!0,opacity:.6,background:"#000000"}).set("styles",{"z-index":1001}).register("login_success",function(e){i.trigger("login_success",e),s.getWeiboInfo({timeout:15e3,onSuccess:function(e){i.trigger("weibo_success",e)},onFailure:function(e){i.trigger("weibo_error",e)}})}).register("logout_success",function(e){i.trigger("logout_success",e)}).register("layer_hide",function(){i.hideTip(),i.trigger("layer_hide",info)}).init(),i.data("init",!0),i.trigger("init","topbar"))}}).init(),i.bind()}},bind:function(){this.dom},fireLoginSuccess:function(){s&&s.listener.fire("login_success")},fireLogoutSuccess:function(){s&&s.listener.fire("logout_success")},showTip:function(e){s=r.SINA_OUTLOGIN_LAYER,u||(u=document.createElement("div"),u.className="sina-top-bar-user-tip",s.nodes&&s.nodes.box&&s.nodes.box.insertBefore(u,s.nodes.box.firstChild)),e&&(u.innerHTML=e,u.style.display="block")},hideTip:function(){u&&(u.style.display="none")},show:function(){if(window.SINA_USER_PANEL){var e=window.SINA_USER_PANEL;try{e.setOutLoginMiddle(!0)}catch(e){}e.getOutLogin().show()}else s.show()}}),c});