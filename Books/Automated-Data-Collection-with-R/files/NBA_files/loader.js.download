define(['require','js/lib/jquery','js/util/clz','js/util/aClz','js/lib/doT','js/util/timeoutHandle'],function(require){var a=require("js/lib/jquery"),g=require("js/util/clz"),c=require("js/util/aClz"),h=(require("js/lib/doT"),require("js/util/timeoutHandle"));return g.c(c,{name:"Loader",read:{url:"",data:{}},hasRightResult:function(a){try{if(0==a.result.status.code)return!0}catch(e){return!1}},timeout:3e4},{bind:function(){var a=this,g=a.opt;a._super(g);var c=[["success",function(){a.toggleTip(),a.toggleLoading(!1)}],["error",function(g,c){a.toggleLoading(!1),a.toggleTip({type:"error",msg:c})}],["beforeRead",function(){a.toggleTip(),a.toggleLoading(!0)}]];a._bindEvent(a,c)},read:function(){var g=this,c=g.opt;optRead=c.read;var R={url:"",data:{},success:function(a){c.hasRightResult(a)?g.trigger("success",a):g.trigger("error","服务器罢工了:("),g.timeoutHandle.success()},error:function(){g.trigger("error","服务器罢工了:("),g.timeoutHandle.success()}};g.trigger("beforeRead"),optRead=a.extend(R,optRead),g.timeoutHandle&&g.timeoutHandle.success(),g.timeoutHandle=h(function(){a.ajax(optRead)},function(){g.trigger("error","连接超时:(")},c.timeout)},toggleLoading:function(a){a?this.dom.loading.show():this.dom.loading.hide()},toggleTip:function(a){var g=this;a?g.dom.tip.html(a.msg+'，<a href="javascript:;" node-type="reload">点击刷新</a>或稍候再试').hide().fadeIn():g.dom.tip.hide()}})});