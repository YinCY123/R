define(['require','js/util/clz','js/util/getNodes','js/util/queryToJson','js/util/jsonToQuery','js/util/renderLazyContent'],function(require){var a=require("js/util/clz"),c=require("js/util/getNodes"),v=require("js/util/queryToJson"),h=require("js/util/jsonToQuery"),y=require("js/util/renderLazyContent"),b="tab-type",g="mouseover",T="undefined"!=typeof window.ontouchstart;T&&(g="touchstart");var w=function(a,c){var v=$("["+b+"=tab-wrap]",a),h=$("["+b+"="+c+"]",a),y=$("");return 0!==v.length&&(v.each(function(){var a=$("["+b+"="+c+"]",$(this));y=y.add(a)}),h=h.not(y)),h},C=function(a){if(!a||0===a.length)return{};var c={clz:"selected",eventType:g,navType:"normal"},h=v(a.attr("tab-data")||"");return $.extend(!0,{},c,h)},j=function(a,c){a.attr("tab-data",h(c))},_=function(a,c,v,h){if(a=$(a),a&&0!==a.length){var g=a.parents("["+b+"=tab-wrap]").eq(0),T=C(g);if(T.eventType===c){var j=T.type;if(!j||"single"!==j||4===arguments.length){var _=T.clz,B="nav-"+_,E="cont-"+_;0===g.length&&(g=$(z));var k=w(g,"tab-nav"),D=w(g,"tab-cont");if("single"===T.navType)a=function(){for(var a=0,i=0,c=D.length;c>i;i++){var v=D.eq(i);if(v.hasClass(E)){a=i+1,a=a>c-1?0:a;break}}return D.eq(a)}();else if(k.length!=D.length)return;D.each(function(i){var c=$(this),b=k.eq(i);c.hasClass(E)&&(b.removeClass(B),c.removeClass(E),"function"==typeof v&&v(b,c)),(b.is(a)||c.is(a))&&(b.addClass(B),c.addClass(E),y(c),"function"==typeof v&&h(b,c))})}}}},z=$("body");z.data("tab-init")||(z.on(g+" click","["+b+"=tab-nav],["+b+"=tab-change]",function(e){_(e.target,e.type),e.preventDefault()}),z.data("tab-init",!0));var B=new a;return B.include({init:function(a,v){var h=this;h.opt=h.setOpt(v),h.dom=c(a,h.opt.attr),h._connect()},setOpt:function(a){var c={start:0,eventType:"mouseover",beforeChange:$.noop,afterChange:$.noop};return T&&(a.eventType="touchstart"),$.extend(!0,{},c,a)},_connect:function(){var a=this;a._disableGlobal(),a._bind()},_disableGlobal:function(){var a=this,c=a.dom.wrap,v=C(c);v.type="single",v.eventType=a.opt.eventType,j(c,v)},switchByEle:function(a){var c=this,v=c.opt;_(a,v.eventType,v.beforeChange,v.afterChange)},_bind:function(){var a=this,c=a.dom.wrap;c.on(a.opt.eventType,"["+b+"=tab-nav]",function(e){var v=$(this),h=v.parents("["+b+"=tab-wrap]").eq(0);c.is(h)&&a.switchByEle($(this)),e.preventDefault()})}}),{switchByEle:_,single:B}});