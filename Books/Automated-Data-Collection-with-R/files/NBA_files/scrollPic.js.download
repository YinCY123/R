define(['require','exports','module'],function(require,exports,module){function ScrollPic(e,t,n,r,i){this.scrollContId=e,this.arrLeftId=t,this.arrRightId=n,this.dotListId=r,this.listType=i,this.dotClassName="dotItem",this.dotOnClassName="dotItemOn",this.dotObjArr=[],this.listEvent="onclick",this.circularly=!0,this.pageWidth=0,this.frameWidth=0,this.speed=10,this.space=10,this.upright=!1,this.pageIndex=0,this.autoPlay=!0,this.autoPlayTime=5,this._autoTimeObj,this._scrollTimeObj,this._state="ready",this.stripDiv=document.createElement("DIV"),this.lDiv01=document.createElement("DIV"),this.lDiv02=document.createElement("DIV")}return ScrollPic.prototype={pageLength:0,touch:!0,scrollLeft:0,eof:!1,bof:!0,initialize:function(){var e=this;if(!this.scrollContId)throw new Error("必须指定scrollContId.");if(this.scDiv=this.$(this.scrollContId),!this.scDiv)throw new Error('scrollContId不是正确的对象.(scrollContId = "'+this.scrollContId+'")');this.scDiv.style[this.upright?"height":"width"]=this.frameWidth+"px",this.scDiv.style.overflow="hidden",this.lDiv01.innerHTML=this.scDiv.innerHTML,this.scDiv.innerHTML="",this.scDiv.appendChild(this.stripDiv),this.stripDiv.appendChild(this.lDiv01),this.circularly&&(this.stripDiv.appendChild(this.lDiv02),this.lDiv02.innerHTML=this.lDiv01.innerHTML,this.bof=!1,this.eof=!1),this.stripDiv.style.overflow="hidden",this.stripDiv.style.zoom="1",this.stripDiv.style[this.upright?"height":"width"]="32766px",this.lDiv01.style.overflow="hidden",this.lDiv01.style.zoom="1",this.lDiv02.style.overflow="hidden",this.lDiv02.style.zoom="1",this.upright||(this.lDiv01.style.cssFloat="left",this.lDiv01.style.styleFloat="left"),this.lDiv01.style.zoom="1",this.circularly&&!this.upright&&(this.lDiv02.style.cssFloat="left",this.lDiv02.style.styleFloat="left"),this.lDiv02.style.zoom="1",this.addEvent(this.scDiv,"mouseover",function(){e.stop()}),this.addEvent(this.scDiv,"mouseout",function(){e.play()}),this.arrLeftId&&(this.alObj=this.$(this.arrLeftId),this.alObj&&(this.addEvent(this.alObj,"mousedown",function(t){e.rightMouseDown(),t=t||event,e.preventDefault(t)}),this.addEvent(this.alObj,"mouseup",function(){e.rightEnd()}),this.addEvent(this.alObj,"mouseout",function(){e.rightEnd()}))),this.arrRightId&&(this.arObj=this.$(this.arrRightId),this.arObj&&(this.addEvent(this.arObj,"mousedown",function(t){e.leftMouseDown(),t=t||event,e.preventDefault(t)}),this.addEvent(this.arObj,"mouseup",function(){e.leftEnd()}),this.addEvent(this.arObj,"mouseout",function(){e.leftEnd()})));var n,r,t=Math.ceil(this.lDiv01[this.upright?"offsetHeight":"offsetWidth"]/this.frameWidth);if(this.pageLength=t,this.dotListId&&(this.dotListObj=this.$(this.dotListId),this.dotListObj.innerHTML="",this.dotListObj))for(n=0;t>n;n++)r=document.createElement("span"),this.dotListObj.appendChild(r),this.dotObjArr.push(r),r.className=n==this.pageIndex?this.dotOnClassName:this.dotClassName,r.innerHTML="number"==this.listType?n+1:"string"==typeof this.listType?this.listType:"",r.title="第"+(n+1)+"页",r.num=n,r[this.listEvent]=function(){e.pageTo(this.num)};this.scDiv[this.upright?"scrollTop":"scrollLeft"]=0,this.autoPlay&&this.play(),this._scroll=this.upright?"scrollTop":"scrollLeft",this._sWidth=this.upright?"scrollHeight":"scrollWidth","function"==typeof this.onpagechange&&this.onpagechange(),this.fireTouch||this.iPad()},leftMouseDown:function(){if("ready"==this._state){var e=this;this._state="floating",clearInterval(this._scrollTimeObj),this._scrollTimeObj=setInterval(function(){e.moveLeft()},this.speed),this.moveLeft()}},rightMouseDown:function(){if("ready"==this._state){var e=this;this._state="floating",clearInterval(this._scrollTimeObj),this._scrollTimeObj=setInterval(function(){e.moveRight()},this.speed),this.moveRight()}},moveLeft:function(){"floating"==this._state&&(this.circularly?this.scDiv[this._scroll]+this.space>=this.lDiv01[this._sWidth]?this.scDiv[this._scroll]=this.scDiv[this._scroll]+this.space-this.lDiv01[this._sWidth]:this.scDiv[this._scroll]+=this.space:this.scDiv[this._scroll]+this.space>=this.lDiv01[this._sWidth]-this.frameWidth?(this.scDiv[this._scroll]=this.lDiv01[this._sWidth]-this.frameWidth,this.leftEnd()):this.scDiv[this._scroll]+=this.space,this.accountPageIndex())},moveRight:function(){"floating"==this._state&&(this.circularly?this.scDiv[this._scroll]-this.space<=0?this.scDiv[this._scroll]=this.lDiv01[this._sWidth]+this.scDiv[this._scroll]-this.space:this.scDiv[this._scroll]-=this.space:this.scDiv[this._scroll]-this.space<=0?(this.scDiv[this._scroll]=0,this.rightEnd()):this.scDiv[this._scroll]-=this.space,this.accountPageIndex())},leftEnd:function(){if("floating"==this._state||"touch"==this._state){this._state="stoping",clearInterval(this._scrollTimeObj);var e=this.pageWidth-this.scDiv[this._scroll]%this.pageWidth;$(this.alObj).css("visibility","visible"),this.move(e)}},rightEnd:function(){if("floating"==this._state||"touch"==this._state){this._state="stoping",clearInterval(this._scrollTimeObj);var e=-this.scDiv[this._scroll]%this.pageWidth;$(this.arObj).css("visibility","visible"),this.move(e)}},move:function(e,t){var n=this,r=e/5,i=!1;t||(r>this.space&&(r=this.space),r<-this.space&&(r=-this.space)),r=Math.abs(r)<1&&0!=r?r>=0?1:-1:Math.round(r);this.scDiv[this._scroll]+r;return r>0?this.circularly?this.scDiv[this._scroll]+r>=this.lDiv01[this._sWidth]?this.scDiv[this._scroll]=this.scDiv[this._scroll]+r-this.lDiv01[this._sWidth]:this.scDiv[this._scroll]+=r:this.scDiv[this._scroll]+r>=this.lDiv01[this._sWidth]-this.frameWidth?(this.scDiv[this._scroll]=this.lDiv01[this._sWidth]-this.frameWidth,this._state="ready",i=!0):this.scDiv[this._scroll]+=r:this.circularly?this.scDiv[this._scroll]+r<0?this.scDiv[this._scroll]=this.lDiv01[this._sWidth]+this.scDiv[this._scroll]+r:this.scDiv[this._scroll]+=r:this.scDiv[this._scroll]+r<=0?(this.scDiv[this._scroll]=0,this._state="ready",i=!0):this.scDiv[this._scroll]+=r,i?void this.accountPageIndex():(e-=r,0==Math.abs(e)?(this._state="ready",this.autoPlay&&this.play(),this.accountPageIndex(),void 0):(clearTimeout(this._scrollTimeObj),void(this._scrollTimeObj=setTimeout(function(){n.move(e,t)},this.speed))))},pre:function(){"ready"==this._state&&(this._state="stoping",this.move(-this.pageWidth))},next:function(e){"ready"==this._state&&(this._state="stoping",this.circularly?this.move(this.pageWidth):this.scDiv[this._scroll]>=this.lDiv01[this._sWidth]-this.frameWidth?(this._state="ready",e&&this.pageTo(0)):this.move(this.pageWidth))},play:function(){var e=this;this.autoPlay&&(clearInterval(this._autoTimeObj),this._autoTimeObj=setInterval(function(){e.next(!0)},1e3*this.autoPlayTime))},stop:function(){clearInterval(this._autoTimeObj)},pageTo:function(e){if(this.pageIndex!=e){0>e&&(e=this.pageLength-1),clearTimeout(this._scrollTimeObj),clearInterval(this._scrollTimeObj),this._state="stoping";var t=e*this.pageWidth-this.scDiv[this._scroll];this.move(t,!0)}},accountPageIndex:function(){var e=Math.round(this.scDiv[this._scroll]/this.frameWidth);e>=this.pageLength&&(e=0),this.scrollLeft=this.scDiv[this._scroll];var t=this.lDiv01[this._sWidth]-this.frameWidth;if(this.circularly||(this.eof=this.scrollLeft>=t,this.bof=this.scrollLeft<=0),"function"==typeof this.onmove&&this.onmove(),e==this.pageIndex)return e-1==0&&this.arrEndHidden,void(this.pageIndex===this.pageLength-2&&this.arrEndHidden);this.pageIndex=e,this.pageIndex>Math.floor(this.lDiv01[this.upright?"offsetHeight":"offsetWidth"]/this.frameWidth)&&(this.pageIndex=0);var n;for(n=0;n<this.dotObjArr.length;n++)this.dotObjArr[n].className=n==this.pageIndex?this.dotOnClassName:this.dotClassName;"function"==typeof this.onpagechange&&this.onpagechange()},iPadX:0,iPadLastX:0,iPadStatus:"ok",iPad:function(){if("undefined"!=typeof window.ontouchstart&&this.touch){var e=this;this.addEvent(this.scDiv,"touchstart",function(t){e._touchstart(t)}),this.addEvent(this.scDiv,"touchmove",function(t){e._touchmove(t)}),this.addEvent(this.scDiv,"touchend",function(t){e._touchend(t)})}},_touchstart:function(e){this.stop(),this.iPadX=e.touches[0].pageX,this.iPadScrollX=window.pageXOffset,this.iPadScrollY=window.pageYOffset,this.scDivScrollLeft=this.scDiv[this._scroll]},_touchmove:function(e){e.touches.length>1&&this._touchend(),this.iPadLastX=e.touches[0].pageX;var t=this.iPadX-this.iPadLastX;if("ok"==this.iPadStatus){if(!(this.iPadScrollY==window.pageYOffset&&this.iPadScrollX==window.pageXOffset&&Math.abs(t)>20))return;this.iPadStatus="touch"}this._state="touch";var n=this.scDivScrollLeft+t;if(n>=this.lDiv01[this._sWidth]){if(!this.circularly)return;n-=this.lDiv01[this._sWidth]}if(0>n){if(!this.circularly)return;n+=this.lDiv01[this._sWidth]}this.scDiv[this._scroll]=n,e.preventDefault()},_touchend:function(){if("touch"==this.iPadStatus){this.iPadStatus="ok";var t=this.iPadX-this.iPadLastX;0>t?this.rightEnd():this.leftEnd(),this.play()}},_overTouch:function(){this.iPadStatus="ok"},$:function(objName){return eval(document.getElementById?'document.getElementById("'+objName+'")':"document.all."+objName)},isIE:-1!=navigator.appVersion.indexOf("MSIE")?!0:!1,addEvent:function(e,t,n){e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener(t,n,!1)},delEvent:function(e,t,n){e.detachEvent?e.detachEvent("on"+t,n):e.removeEventListener(t,n,!1)},preventDefault:function(e){e.preventDefault?e.preventDefault():e.returnValue=!1}},ScrollPic});