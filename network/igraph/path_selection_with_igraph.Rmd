---
title: "path_selection_with_igraph"
author: "yincy"
date: "4/26/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
nodes <- read.csv(file = "Dataset1-Media-Example-NODES.csv", header = TRUE, as.is = TRUE)
# the first column is the vertex id, other column trited as vertex attributes

links <- read.csv(file = "Dataset1-Media-Example-EDGES.csv", header = TRUE, as.is = TRUE)
# the first two columns are the vertex ids that this edge between, and the other columns are the edge attributes
```


```{r}
links <- aggregate(x = links[, 3], by = links[, -3], FUN = sum)
```


```{r}
net <- graph_from_data_frame(d = links, 
                             directed = T, 
                             vertices = nodes)
```

```{r}
net
```

```{r}
dis_to_s07 <- distances(graph = net, 
                        to = V(net), 
                        v = V(net)$name == "s07", 
                        mode = "out")
dis_to_s07
```

```{r}
all_path_to_s07 <- all_simple_paths(graph = net, 
                                    from = V(net)$name == "s07", 
                                    to = dis_to_s07[1, ][dis_to_s07 == 3] %>% names())
```


```{r}
all_path_to_s07 %>% class()
all_path_to_s07_3 <- all_path_to_s07[sapply(all_path_to_s07, length) == 4]
```

```{r}
epath <- E(net)[V(net)[name == "s07"] %->% V(net)[name %in% c("s02", "s06", "s15", "s17")]]
```

```{r}
vcol <- rep("grey", vcount(net))
vcol[V(net)$name %in% (all_path_to_s07_3[[1]] %>% names())] <- "tomato"

ecol <- rep("grey", ecount(net))
ecol[epath] <- "blue"

plot(net, vertex.color = vcol, 
     edge.color = ecol, 
     edge.arrow.size = 0.3)
```










